# 非機能要件（NFR）— Step1 기준（Step2にも引き継ぐ）

---

## 1. セキュリティ
### 1.1 機密情報
- APIキー/トークン/秘密鍵などの秘匿情報は **Backendの環境変数**で管理する
- **FrontにAPIキーを埋め込まない**
- ログに秘匿情報を出力しない（例：ヘッダ・環境変数の丸出し禁止）

### 1.2 通信
- Step1：Backendは原則 `127.0.0.1` bind（ローカルのみ）
- Step2：Backendは host-only からのみ到達できるようFW制限する

### 1.3 入力データ
- ユーザー入力/ページ情報を外部へ送る場合は最小限にし、必要ならマスク/要約する方針を検討する（MVPでは最小に）

---

## 2. 性能
- チャット応答は外部API依存のため、通常数秒〜十数秒を許容（MVP）
- UIは送信中もフリーズしない（ローディング表示）

---

## 3. 可用性・障害時挙動
- Backend未起動時：
  - Frontは `/health` により検知できること
  - UIに「backendを起動してください」等の次アクションを表示
- 外部API失敗時：
  - ユーザーに理解できるエラー表示
  - エラーコード（後述）を返す

---

## 4. ロギング / 観測性
- Backend：
  - 最小限のアクセスログ（path / status / duration）
  - エラーログ（stacktraceは保存可だが秘匿情報は含めない）
- Front：
  - 重大エラー時のみ console に出す（個人情報・秘匿情報を出さない）

---

## 5. エラーコード（例）
- `BACKEND_UNREACHABLE`：backendに到達できない
- `TIMEOUT`：バックエンド応答がタイムアウト
- `UPSTREAM_ERROR`：外部API（LLM）が失敗
- `INVALID_REQUEST`：requestが不正（必須項目欠落など）

---

## 6. 受け入れ基準（Step1）
- 指定サイトでのみモーダル表示
- ドラッグで移動可能
- 送信→backend→外部API→返答が成立
- backend停止時に適切にエラー表示
- APIキーがFront側に存在しない
